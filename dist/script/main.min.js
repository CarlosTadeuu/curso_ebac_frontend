let compradores=[],totalCartelas=0,currentSkin="";function salvarDadosSkin(e,a,t){localStorage.setItem(e,JSON.stringify({totalRifa:a,compradores:t})),atualizarSugestoesSkins(),atualizarSugestoesCompradores()}function carregarDadosSkin(e){var a,e=localStorage.getItem(e);return e?({totalRifa:e,compradores:a}=JSON.parse(e),compradores=a,criarCartelas(e),compradores.forEach(({cartelas:e})=>{e.forEach(e=>{var e=document.getElementById("cartela-"+e);e&&((e=e.querySelector("img")).style.display="block",e.style.width="50px",e.style.height="50px")})}),document.getElementById("apagar-skin").style.display="inline",e):(document.getElementById("apagar-skin").style.display="none",null)}function apagarSkin(){currentSkin&&(localStorage.removeItem(currentSkin),resetarJogo(),alert(`Skin "${currentSkin}" apagada com sucesso.`))}function cadastrarRifa(e){e.preventDefault();e=document.getElementById("name-skin-input").value;if(e){e=carregarDadosSkin(currentSkin=e);if(e)totalCartelas=e,document.getElementById("TotalRifa").value=totalCartelas,document.getElementById("TotalRifa").disabled=!0;else{e=parseInt(document.getElementById("TotalRifa").value);if(isNaN(e)||e<=0)return void alert("Por favor, insira um número válido de rifas.");criarCartelas(totalCartelas=e),compradores=[]}salvarDadosSkin(currentSkin,totalCartelas,compradores)}else alert("Por favor, insira o nome da skin.")}function cadastrarComprador(a){a.preventDefault();let t=document.getElementById("name-comprador").value;a=document.getElementById("number-cartela").value.split(",").map(e=>parseInt(e.trim()));let r=compradores.flatMap(e=>e.cartelas);var e=a.filter(e=>r.includes(e));if(0<e.length)alert(`Os números já comprados são: ${e.join(", ")}. Escolha outros números.`);else{let e=compradores.find(e=>e.nome===t);e?e.cartelas.push(...a):(e={nome:t,cartelas:a},compradores.push(e)),a.forEach(e=>{var e=document.getElementById("cartela-"+e);e&&((e=e.querySelector("img")).style.display="block",e.style.width="50px",e.style.height="50px")}),salvarDadosSkin(currentSkin,totalCartelas,compradores),document.getElementById("name-comprador").value="",document.getElementById("number-cartela").value=""}}function criarCartelas(a){var t=document.getElementById("cartelas-list");t.innerHTML="";for(let e=1;e<=a;e++){var r=document.createElement("li");r.classList.add("cartela"),r.id="cartela-"+e,r.innerHTML=`
            <h2>${e}</h2>
            <img src="./img/letra-x.png" alt="letra-x" style="display: none;">
        `,t.appendChild(r)}}function atualizarSugestoesSkins(){var a=document.getElementById("skins-list");a.innerHTML="";for(let e=0;e<localStorage.length;e++){var t=localStorage.key(e),r=document.createElement("option");r.value=t,a.appendChild(r)}}function atualizarSugestoesCompradores(){let t=document.getElementById("compradores-list");t.innerHTML="",compradores.forEach(({nome:e})=>{var a=document.createElement("option");a.value=e,t.appendChild(a)})}function resetarJogo(){compradores=[],totalCartelas=0,document.getElementById("cartelas-list").innerHTML="",document.getElementById("name-skin-input").value="",document.getElementById("TotalRifa").value="",document.getElementById("TotalRifa").disabled=!1,document.getElementById("apagar-skin").style.display="none"}function sortear(){var e;0===compradores.length?alert("Nenhum comprador foi registrado."):(e=(e=compradores.flatMap(e=>e.cartelas))[Math.floor(Math.random()*e.length)],alert("Número sorteado: "+e))}function mostrarSkinsCompradas(){let a=document.getElementById("name-comprador").value;if(a){var e=compradores.find(e=>e.nome===a);if(e){let t=document.getElementById("cartelas-compradas");t.innerHTML="",0<e.cartelas.length?e.cartelas.forEach(e=>{var a=document.createElement("li");a.textContent="Cartela: "+e,t.appendChild(a)}):alert("Este comprador não comprou nenhuma cartela.")}else alert("Comprador não encontrado.")}else alert("Por favor, selecione um comprador.")}document.getElementById("nomeDaRifa").addEventListener("submit",cadastrarRifa),document.getElementById("cadastro-comprador").addEventListener("submit",cadastrarComprador),document.getElementById("apagar-skin").addEventListener("click",apagarSkin),document.getElementById("mostrar-skins").addEventListener("click",mostrarSkinsCompradas),atualizarSugestoesSkins(),atualizarSugestoesCompradores();